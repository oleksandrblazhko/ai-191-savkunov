# V2.7 Позадіапазонний верифікатор
У минулому звичайним інструментом позасмугової перевірки був електронний лист або SMS із посиланням для зміни пароля. Зловмисники використовують цей слабкий механізм, щоб скинути облікові записи, які вони ще не контролюють, наприклад заволодіти обліковим записом електронної пошти особи та повторно використати будь-які виявлені посилання скидання. Існують кращі способи перевірки поза діапазоном.
Захищені позасмугові автентифікатори – це фізичні пристрої, які можуть спілкуватися з верифікатором через захищений вторинний канал. Приклади включають push-повідомлення на мобільні пристрої. Цей тип автентифікатора вважається "тем, що у вас є". Коли користувач бажає пройти автентифікацію, перевіряюча програма надсилає повідомлення зовнішньому автентифікатору через з’єднання з автентифікатором прямо чи опосередковано через
сервіс третьої сторони. Повідомлення містить код автентифікації (зазвичай випадкове шестизначне число або модальне діалогове вікно затвердження). Програма перевірки чекає отримання коду автентифікації через основний канал і порівнює хеш отриманого значення з хешем вихідного коду автентифікації. Якщо вони збігаються, зовнішній верифікатор може вважати, що користувач пройшов автентифікацію.
ASVS припускає, що лише кілька розробників розроблятимуть нові зовнішні автентифікатори, такі як push-повідомлення, і, таким чином, наступні елементи керування ASVS застосовуються до верифікаторів, таких як API автентифікації, програми та реалізації єдиного входу. Якщо розробляється новий зовнішній автентифікатор, зверніться до NIST 800-63B § 5.1.3.1.
Небезпечні засоби зовнішньої автентифікації, такі як електронна пошта та VOIP, заборонені. PSTN і автентифікація через SMS наразі "обмежені" NIST і повинні бути застарілими на користь push-повідомлень або подібних. Якщо вам потрібно використовувати автентифікацію по телефону або через SMS, див. § 5.1.3.3.

## 2.7.1 Переконайтеся, що за замовчуванням не пропонуються позасмугові автентифікатори відкритого тексту (NIST "з обмеженнями"), такі як SMS або PSTN, і що спочатку пропонуються потужніші альтернативи, такі як push-повідомлення.
Коли актор стверджує, що має певну особу, продукт не доводить або недостатньо доводить, що твердження є правильним.
аутентифікація:
Альтернативним терміном є «автентифікація», який, здається, найчастіше використовують люди з неангломовних країн.
AuthN:
"AuthN" зазвичай використовується як абревіатура "автентифікації" в спільноті безпеки веб-додатків. Він також відрізняється від «AuthZ», що є абревіатурою «авторизації». Не рекомендується використовувати «Auth» як абревіатуру, оскільки вона може використовуватися як для автентифікації, так і для авторизації.
AuthC:
«AuthC» використовується як абревіатура «authentication», але, здається, використовується рідше, ніж «AuthN».
Ієрархія
Релевантність перегляду "Концепції дослідження" (CWE-1000)
|Природа |Тип |Ідентифікатор |Найменування|
|:-:|:-:|:-:|:-:|
|ChildOf |Pillar |284 |Неналежний контроль доступу|
|ParentOf |Base |295 |Неналежна перевірка сертифіката|
|ParentOf |Base |306 |Відсутня автентифікація для критичної функції|
|ParentOf |Base |645 |Надмірно обмежений механізм блокування облікового запису|
|ParentOf |Клас |1390 |Слабка автентифікація|
|CanFollow |База |613 |Недостатній термін сеансу|

## 2.7.2 Переконайтеся, що позасмуговий верифікатор закінчує термін дії запитів на позасмугову автентифікацію, кодів або маркерів через 10 хвилин.
Коли актор стверджує, що має певну особу, продукт не доводить або недостатньо доводить, що твердження є правильним.

## 2.7.3 Переконайтеся, що запити на автентифікацію, коди або маркери зовнішнього верифікатора можна використовувати лише один раз і лише для початкового запиту на автентифікацію.
Коли актор стверджує, що має певну особу, продукт не доводить або недостатньо доводить, що твердження є правильним.

## 2.7.4 Переконайтеся, що зовнішній автентифікатор і верифікатор спілкуються через безпечний незалежний канал.
Сторінки входу не використовують належних заходів для захисту імені користувача та пароля під час їх передачі від клієнта до сервера.
Релевантність перегляду "Концепції дослідження" (CWE-1000)
|Ім'я |ID |типу |природи|
|:-:|:-:|:-:|:-:|
|ChildOf |Class |522 |Недостатньо захищені облікові дані|
|CanAlsoBe |Base |312 |Зберігання конфіденційної інформації в відкритому тексті|

## 2.7.5 Переконайтеся, що зовнішній верифікатор зберігає лише хешовану версію коду автентифікації.
Зберігання пароля у вигляді відкритого тексту може призвести до зламу системи.
Проблеми з керуванням паролем виникають, коли пароль зберігається у вигляді відкритого тексту у властивостях програми, файлі конфігурації або пам’яті. Зберігання простого текстового пароля у файлі конфігурації дозволяє кожному, хто може читати файл, отримати доступ до захищеного паролем ресурсу. У деяких контекстах навіть зберігання простого текстового пароля в пам’яті вважається загрозою безпеці, якщо пароль не скидається одразу після його використання.

## 2.7.6 Переконайтеся, що початковий код автентифікації генерується захищеним генератором випадкових чисел, що містить принаймні 20 біт ентропії (зазвичай достатньо шестицифрового випадкового числа).
Слабкі сторони цієї категорії пов’язані з розробкою та впровадженням конфіденційності та цілісності даних. Часто вони мають справу з використанням методів кодування, бібліотек шифрування та алгоритмів хешування. Слабкі місця в цій категорії можуть призвести до погіршення якості даних, якщо їх не усунути.












