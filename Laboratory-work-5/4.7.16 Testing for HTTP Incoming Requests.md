# Тестування вхідних запитів HTTP

У цьому розділі описано, як контролювати всі вхідні/вихідні HTTP-запити як на стороні клієнта, так і на стороні сервера. Мета цього тестування — перевірити, чи надсилаються непотрібні або підозрілі запити HTTP у фоновому режимі.

Більшість інструментів тестування веб-безпеки (наприклад, AppScan, BurpSuite, ZAP) діють як HTTP-проксі. Для цього знадобляться зміни проксі-сервера в клієнтській програмі або браузері. Методи тестування, наведені нижче, в основному зосереджені на тому, як ми можемо відстежувати HTTP-запити без змін на стороні клієнта, що буде ближче до сценарію робочого використання.

# Цілі тесту
- Відстежуйте всі вхідні та вихідні HTTP-запити до веб-сервера, щоб перевірити будь-які підозрілі запити.
- Відстежуйте HTTP-трафік без змін проксі-сервера кінцевого користувача або клієнтської програми.

# Як тестувати
## Зворотний проксі
Виникла ситуація, коли ми хотіли б відстежувати всі вхідні запити HTTP на веб-сервері, але ми не можемо змінити конфігурацію на стороні клієнта браузера чи програми. У цьому сценарії ми можемо налаштувати зворотний проксі-сервер на кінці веб-сервера для моніторингу всіх вхідних/вихідних запитів на веб-сервері.

Для платформи Windows рекомендовано Fiddler. Він забезпечує не тільки моніторинг, але також може редагувати/відповідати на запити HTTP. Зверніться до цього посилання, щоб дізнатися, як налаштувати Fiddler як зворотний проксі

Для платформи Linux можна використовувати Charles Web Debugging Proxy.

Етапи тестування:

1. Встановіть Fiddler або Charles на веб-сервері
2. Налаштуйте Fiddler або Charles як зворотний проксі
3. Перехоплення HTTP-трафіку
4. Перевірте HTTP-трафік
5. Змініть HTTP-запити та відтворіть змінені запити для тестування

# Переадресація портів
Перенаправлення портів — ще один спосіб, який дозволяє нам перехоплювати HTTP-запити без змін на стороні клієнта. Ви також можете використовувати Charles як проксі-сервер SOCKS для перенаправлення портів або використовувати інструменти перенаправлення портів. Це дозволить нам перенаправляти весь отриманий клієнтський трафік на порт веб-сервера.

Потік тестування буде таким:

1. Встановіть Charles або перенаправлення портів на іншу машину або веб-сервер
2. Налаштуйте проксі-сервер Charles as Socks як переадресацію портів.

# Перехоплення мережевого трафіку на рівні TCP
Ця техніка відстежує весь мережевий трафік на рівні TCP. Можна використовувати інструменти TCPDump або WireShark. Однак ці інструменти не дозволяють редагувати отриманий трафік і надсилати модифіковані HTTP-запити для тестування. Щоб відтворити пакети захопленого трафіку (PCAP), можна використовувати Ostinato.

Етапи тестування будуть такими:

1. Активуйте TCPDump або WireShark на веб-сервері, щоб перехопити мережевий трафік
2. Моніторинг захоплених файлів (PCAP)
3. Редагуйте файли PCAP за допомогою інструменту Ostinato відповідно до потреб
4. Відповісти на HTTP-запити

Fiddler або Charles рекомендовано, оскільки ці інструменти можуть перехоплювати HTTP-трафік, а також легко редагувати/відповідати на змінені HTTP-запити. Крім того, якщо веб-трафік є HTTPS, wireshark потрібно буде імпортувати закритий ключ веб-сервера, щоб перевірити тіло повідомлення HTTPS. В іншому випадку тіло HTTPS-повідомлення захопленого трафіку буде зашифровано.